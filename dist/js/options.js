(()=>{"use strict";const t={primary:"#4A90E2",secondary:"#50E3C2",accent:"#F5A623",keyword:"#C678DD",string:"#98C379",comment:"#5C6370",function:"#61AFEF",variable:"#E06C75",type:"#E5C07B",background:{dark:"#282C34",light:"#FFFFFF"},text:{dark:"#ABB2BF",light:"#383A42"},highlight:{animation:{start:localStorage.getItem("highlightStartColor")||"rgba(74, 144, 226, 0.1)",end:localStorage.getItem("highlightEndColor")||"rgba(74, 144, 226, 0.3)"}}},e='IMPORTANT: You must follow these rules exactly:\n1. Return ONLY a JSON array of objects\n2. Each object must have one property:\n   - text: the exact text content to highlight\n3. Format must be: [{"text": string}, ...]\n4. No text before or after the JSON\n5. No comments or explanations\n6. No markdown formatting\n7. Array can be empty but must be valid JSON\n8. The "text" property must contain the exact text to highlight\n9. Each text segment should be meaningful and complete\n10. Do not include partial words or incomplete phrases\n\nAnalyze the following text and identify {purpose} to highlight.';function n(t,n){return e.replace("{purpose}","custom"===t?n:{gre:"GRE vocabulary words",important:"important information and key points",definition:"term definitions and explanations",conclusion:"conclusions and summary statements"}[t]||"")}async function o(){const t=document.getElementById("save");t.textContent,t.textContent="Saving...",t.disabled=!0;try{const e=document.getElementById("presetPrompt").value,o=document.getElementById("customPrompt").value,a=document.getElementById("colorSlider"),i=(t=>{const e=70*Math.min(.6,.4)/100,n=n=>{const o=(n+t/30)%12,a=.6-e*Math.max(Math.min(o-3,9-o,1),-1);return Math.round(255*a).toString(16).padStart(2,"0")};return`#${n(0)}${n(8)}${n(4)}`})(parseInt(a?.value||"0")),s={apiKey:document.getElementById("apiKey").value,baseUrl:document.getElementById("baseUrl").value,model:document.getElementById("model").value,presetPrompt:e,customPrompt:o,prompt:n(e,o),highlightColor:i,apiRateLimit:parseInt(document.getElementById("apiRateLimit").value),maxCacheSize:parseInt(document.getElementById("maxCacheSize").value),maxRetries:parseInt(document.getElementById("maxRetries").value),retryDelay:parseInt(document.getElementById("retryDelay").value)};await chrome.storage.sync.set({highlightSettings:s}),t.textContent="Saved!",setTimeout((()=>{t.textContent="Save",t.disabled=!1}),2e3)}catch(t){console.error("Failed to save settings:",t);const e=document.getElementById("status");e&&(e.textContent="Failed to save settings",e.classList.add("visible"),setTimeout((()=>{e.classList.remove("visible")}),2e3))}}function a(){const t=document.getElementById("presetPrompt"),e=document.getElementById("customPromptGroup");e&&(e.style.display="custom"===t.value?"block":"none")}async function i(){try{const{whitelistedSites:t=[]}=await chrome.storage.sync.get({whitelistedSites:[]}),e=document.getElementById("whitelistContainer");e&&(e.innerHTML="",t.forEach((t=>{const n=document.createElement("div");n.className="flex justify-between items-center p-2 bg-gray-50 rounded",n.innerHTML=`\n          <span class="text-gray-700">${t}</span>\n          <button class="text-red-500 hover:text-red-700 focus:outline-none" data-site="${t}">\n            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">\n              <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd" />\n            </svg>\n          </button>\n        `,e.appendChild(n)})),e.querySelectorAll("button").forEach((t=>{t.addEventListener("click",(async()=>{const e=t.getAttribute("data-site");if(e){const{whitelistedSites:t=[]}=await chrome.storage.sync.get({whitelistedSites:[]}),n=t.filter((t=>t!==e));await chrome.storage.sync.set({whitelistedSites:n}),i()}}))})))}catch(t){console.error("Failed to load whitelisted sites:",t)}}document.addEventListener("DOMContentLoaded",(async()=>{try{await async function(){try{const{highlightSettings:t}=await chrome.storage.sync.get({highlightSettings:{apiKey:"",baseUrl:"https://api.openai.com",model:"gpt-3.5-turbo",presetPrompt:"important",customPrompt:"",prompt:n("important",""),highlightColor:"#4A90E2",apiRateLimit:5e3,maxCacheSize:100,maxRetries:3,retryDelay:1e3}});document.getElementById("apiKey").value=t.apiKey,document.getElementById("baseUrl").value=t.baseUrl,document.getElementById("model").value=t.model,document.getElementById("presetPrompt").value=t.presetPrompt,document.getElementById("customPrompt").value=t.customPrompt,document.getElementById("prompt").value=t.prompt;const e=document.getElementById("colorSlider");if(e){const n=(t=>{let e=parseInt(t.slice(1,3),16)/255,n=parseInt(t.slice(3,5),16)/255,o=parseInt(t.slice(5,7),16)/255;const a=Math.max(e,n,o),i=Math.min(e,n,o);let s,r=0,l=(a+i)/2;if(a===i)r=s=0;else{const t=a-i;switch(s=l>.5?t/(2-a-i):t/(a+i),a){case e:r=(n-o)/t+(n<o?6:0);break;case n:r=(o-e)/t+2;break;case o:r=(e-n)/t+4}r/=6}return{h:360*r,s:100*s,l:100*l}})(t.highlightColor);e.value=n.h.toString();const o=document.getElementById("colorIndicator");o&&(o.style.left=n.h/360*100+"%")}document.getElementById("apiRateLimit").value=String(t.apiRateLimit||5e3),document.getElementById("maxCacheSize").value=String(t.maxCacheSize||100),document.getElementById("maxRetries").value=String(t.maxRetries||3),document.getElementById("retryDelay").value=String(t.retryDelay||1e3),a()}catch(t){console.error("Failed to load settings:",t)}}(),await i(),function(){const t=document.getElementById("advancedSettingsToggle"),e=document.getElementById("advancedSettingsContent"),n=document.getElementById("advancedSettingsIcon");t&&e&&n&&(e.style.maxHeight="0px",n.style.transform="rotate(0deg)",t.addEventListener("click",(()=>{const t="0px"!==e.style.maxHeight;e.style.maxHeight=t?"0px":e.scrollHeight+"px",n.style.transform=t?"rotate(0deg)":"rotate(180deg)"})))}(),function(){const e=document.getElementById("colorSlider"),n=document.getElementById("colorIndicator");if(!e||!n)return void console.error("Color slider elements not found");const o=localStorage.getItem("highlightColor")||"#4A90E2",a=(t,e,n)=>{n/=100;const o=e*Math.min(n,1-n)/100,a=e=>{const a=(e+t/30)%12,i=n-o*Math.max(Math.min(a-3,9-a,1),-1);return Math.round(255*i).toString(16).padStart(2,"0")};return`#${a(0)}${a(8)}${a(4)}`},i=o=>{const a=(t=>{let e=parseInt(t.slice(1,3),16)/255,n=parseInt(t.slice(3,5),16)/255,o=parseInt(t.slice(5,7),16)/255;const a=Math.max(e,n,o),i=Math.min(e,n,o);let s,r=0,l=(a+i)/2;if(a===i)r=s=0;else{const t=a-i;switch(s=l>.5?t/(2-a-i):t/(a+i),a){case e:r=(n-o)/t+(n<o?6:0);break;case n:r=(o-e)/t+2;break;case o:r=(e-n)/t+4}r/=6}return{h:360*r,s:100*s,l:100*l}})(o);var i,s;e.value=a.h.toString(),n.style.left=a.h/360*100+"%",localStorage.setItem("highlightColor",o),i=o,s=o,t.highlight.animation.start=i,t.highlight.animation.end=s,localStorage.setItem("highlightStartColor",i),localStorage.setItem("highlightEndColor",s)};i(o),e.addEventListener("input",(t=>{const e=parseInt(t.target.value),o=a(e,70,60);n.style.left=e/360*100+"%",i(o)}));let s=!1;const r=e.getBoundingClientRect();n.addEventListener("mousedown",(()=>{s=!0})),document.addEventListener("mousemove",(t=>{s&&(t=>{const o=Math.max(0,Math.min(1,(t-r.left)/r.width)),s=Math.round(360*o),l=a(s,70,60);e.value=s.toString(),n.style.left=100*o+"%",i(l)})(t.clientX)})),document.addEventListener("mouseup",(()=>{s=!1}))}(),chrome.storage.onChanged.addListener(((t,e)=>{"sync"===e&&t.whitelistedSites&&i()}));const s=document.getElementById("addToWhitelist"),r=document.getElementById("whitelistInput");s?.addEventListener("click",(async()=>{if(r?.value){const t=r.value.trim();await async function(t){try{const{whitelistedSites:e=[]}=await chrome.storage.sync.get({whitelistedSites:[]});return!e.includes(t)&&(e.push(t),await chrome.storage.sync.set({whitelistedSites:e}),i(),!0)}catch(t){return console.error("Failed to add site to whitelist:",t),!1}}(t)&&(r.value="")}})),document.getElementById("save")?.addEventListener("click",o),document.getElementById("presetPrompt")?.addEventListener("change",a),document.getElementById("resetPrompt")?.addEventListener("click",(()=>{const t=document.getElementById("prompt");t&&(t.value=e)}))}catch(t){console.error("Failed to initialize options page:",t)}}))})();
//# sourceMappingURL=options.js.map