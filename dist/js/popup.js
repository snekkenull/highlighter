(()=>{"use strict";async function t(){const{whitelistedSites:t=[]}=await chrome.storage.sync.get({whitelistedSites:[]});return t}async function e(e){const i=await t(),a=new URL(e).hostname;return i.includes(a)}async function i(t){const e=document.getElementById("toggleHighlight");e&&(e.textContent=t?"Stop Highlighting":"Start Highlighting",e.classList.toggle("bg-red-500",t),e.classList.toggle("bg-primary-light",!t))}async function a(){try{const[t]=await chrome.tabs.query({active:!0,currentWindow:!0});if(t.id&&t.url)try{const e=await chrome.tabs.sendMessage(t.id,{action:"toggleHighlight"});await i(e.isEnabled)}catch(e){await chrome.scripting.executeScript({target:{tabId:t.id},files:["content.js"]}),await new Promise((t=>setTimeout(t,500)));const a=await chrome.tabs.sendMessage(t.id,{action:"toggleHighlight"});await i(a.isEnabled)}}catch(t){console.error("Failed to toggle highlight:",t)}}async function n(){try{const[t]=await chrome.tabs.query({active:!0,currentWindow:!0});t.id&&await chrome.tabs.sendMessage(t.id,{action:"clearHighlights"})}catch(t){console.error("Failed to clear highlights:",t)}}async function s(){try{const[i]=await chrome.tabs.query({active:!0,currentWindow:!0});if(i.url){const a=await e(i.url),n=document.getElementById("toggleWhitelist");a?(await async function(e){const i=await t(),a=new URL(e).hostname,n=i.filter((t=>t!==a));await chrome.storage.sync.set({whitelistedSites:n})}(i.url),n&&(n.textContent="Add to Whitelist",n.disabled=!1)):(await async function(e){const i=await t(),a=new URL(e).hostname;i.includes(a)||(i.push(a),await chrome.storage.sync.set({whitelistedSites:i}))}(i.url),n&&(n.textContent="Added to Whitelist",n.disabled=!1)),await chrome.runtime.sendMessage({action:"whitelistUpdated",url:i.url}),i.id&&await chrome.tabs.reload(i.id)}}catch(t){console.error("Failed to toggle whitelist:",t)}}document.addEventListener("DOMContentLoaded",(async()=>{!async function(){const t=document.getElementById("status"),{highlightSettings:e}=await chrome.storage.sync.get({highlightSettings:{apiKey:"",baseUrl:"https://api.openai.com",model:"gpt-3.5-turbo"}});if(t){const i=t.querySelector(".status-active"),a=t.querySelector(".status-inactive");e?.apiKey?(i?.classList.remove("hidden"),a?.classList.add("hidden")):(i?.classList.add("hidden"),a?.classList.remove("hidden"))}}();const[t]=await chrome.tabs.query({active:!0,currentWindow:!0});if(t.url&&t.id){const a=await e(t.url),n=document.getElementById("toggleWhitelist");n&&(n.textContent=a?"Added to Whitelist":"Add to Whitelist",n.disabled=!1,n.addEventListener("click",s));const c=await async function(t){try{return(await chrome.tabs.sendMessage(t,{action:"getHighlightingState"})).isEnabled}catch{return!1}}(t.id);await i(c)}document.getElementById("toggleHighlight")?.addEventListener("click",a),document.getElementById("clearHighlights")?.addEventListener("click",n),document.getElementById("openSettings")?.addEventListener("click",(t=>{t.preventDefault(),chrome.runtime.openOptionsPage()}))}))})();
//# sourceMappingURL=popup.js.map